<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Adaptive Framework: Building for Ubuntu Linux</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Adaptive Framework
   &#160;<span id="projectnumber">0.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Building for Ubuntu Linux </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>(tested on Ubuntu 20.04 LTS, 64-bit)</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Source Build Dependencies</h1>
<pre class="fragment">sudo apt-get install git
sudo apt-get install autotools-dev autoconf libtool pkg-config
</pre> <h1><a class="anchor" id="autotoc_md2"></a>
Fetch Source</h1>
<pre class="fragment"># Fetch source for Adaptive Framework, using the 'develop' branch
git clone https://github.com/afw-org/afw.git    
</pre> <h1><a class="anchor" id="autotoc_md3"></a>
Rules to run at install time. AdaptiveFramework Core dependencies</h1>
<pre class="fragment"># Apache Run Time and Apache2 Dev
sudo apt-get install libapr1 libapr1-dev apache2-dev

# libxml2
sudo apt-get install libxml2 libxml2-dev

# libicu for Unicode support
sudo apt-get install libicu-dev

# libunwind for stack trace
sudo apt-get install libunwind-setjmp0-dev

# libdw for ELF symbols
sudo apt-get install elfutils libdw-dev
</pre> <h1><a class="anchor" id="autotoc_md4"></a>
Rules to run at install time. AdaptiveFramework Adaptor dependencies</h1>
<p>Eventually, these adaptors will not be required, but rather enabled/disabled via the configure script. </p><pre class="fragment"># MySQL Adaptor
sudo apt-get install libmysqlclient-dev

# BerkeleyDB Adaptor
sudo apt-get install libdb-dev

# LightningDB Adaptor
sudo apt-get install liblmdb-dev

# need OpenSSL and CURL for DynamoDB adaptor dependencies
sudo apt-get install libcurl4-openssl-dev libssl-dev

# Drivers for APR DBD interface
sudo apt-get install libaprutil1-dbd-mysql 
sudo apt-get install libaprutil1-dbd-sqlite3 
sudo apt-get install libaprutil1-dbd-odbc
sudo apt-get install libaprutil1-dbd-pgsql
</pre> <h1><a class="anchor" id="autotoc_md5"></a>
Rules to run at install time. dependencies for content-types</h1>
<pre class="fragment"># YAML
sudo apt-get install libyaml-dev
</pre> <h1><a class="anchor" id="autotoc_md6"></a>
Rules to run at install time. HTTP stack, used by AdaptiveFramework</h1>
<pre class="fragment"># FastCGI library
sudo apt-get install libfcgi-dev

# NGNIX
sudo apt-get install nginx
</pre> <h1><a class="anchor" id="autotoc_md7"></a>
Development tools (optional)</h1>
<pre class="fragment"># debugging
sudo apt-get install gdb
sudo apt-get install valgrind
sudo apt-get install lsof

# python stuff
pip install -r python-requirements.txt
</pre> <h1><a class="anchor" id="autotoc_md8"></a>
Building Adaptive Framework</h1>
<pre class="fragment">cd afw
./afwdev build    
make
</pre> <h1><a class="anchor" id="autotoc_md9"></a>
Rules to run at install time. Adaptive Framework</h1>
<pre class="fragment">./afwdev build --install
</pre><h1><a class="anchor" id="autotoc_md10"></a>
TL;DR</h1>
<pre class="fragment">sudo apt-get install git autotools-dev autoconf libtool pkg-config libapr1 libapr1-dev apache2-dev libxml2 libxml2-dev libicu-dev libmysqlclient-dev libdb-dev liblmdb-dev libcurl4-openssl-dev libssl-dev libyaml-dev libfcgi-dev nginx libunwind-setjmp0-dev elfutils libdw-dev
git clone https://github.com/afw-org/afw.git    
cd afw
./afwdev build --install
</pre><h1><a class="anchor" id="autotoc_md11"></a>
Building on RockyLinux</h1>
<h2><a class="anchor" id="autotoc_md12"></a>
Rules to run at install time. software dependencies</h2>
<pre class="fragment">dnf install -y epel-release &amp;&amp; \
dnf --enablerepo=PowerTools install -y autoconf make libtool \
    apr-devel apr-util-mysql apr-util-ldap \
    libxml2-devel libicu-devel \
    elfutils elfutils-devel libunwind-devel \
    httpd-devel mariadb mariadb-devel libdb-devel lmdb lmdb-devel \
    libcurl-devel libyaml libyaml-devel \
    python3-pip python3-devel \
    fcgi fcgi-devel wget git \
    ruby-devel rpm-build rubygems \
    openssl openssl-devel
</pre> <h2><a class="anchor" id="autotoc_md13"></a>
Rules to run at install time. python packages</h2>
<pre class="fragment">pip3.6 install requests inflection lxml watchdog
</pre> <h2><a class="anchor" id="autotoc_md14"></a>
Rules to run at install time. FPM (for creating RPMS)</h2>
<pre class="fragment">gem install --no-ri --no-rdoc fpm
</pre> <h2><a class="anchor" id="autotoc_md15"></a>
Building Adaptive Framework</h2>
<pre class="fragment">cd afw
./afwdev build
</pre> <h2><a class="anchor" id="autotoc_md16"></a>
Rules to run at install time. Adaptive Framework</h2>
<pre class="fragment">./afwdev build --install
</pre> <h2><a class="anchor" id="autotoc_md17"></a>
TL;DR</h2>
<pre class="fragment">dnf install -y epel-release &amp;&amp; \
dnf --enablerepo=PowerTools install -y autoconf make libtool \
    apr-devel apr-util-mysql apr-util-ldap \
    libxml2-devel libicu-devel \
    elfutils elfutils-devel libunwind-devel \
    httpd-devel mariadb mariadb-devel libdb-devel lmdb lmdb-devel \
    libcurl-devel libyaml libyaml-devel \
    python3-pip python3-devel \
    fcgi fcgi-devel wget git \
    ruby-devel rpm-build rubygems \
    openssl openssl-devel
git clone https://github.com/afw-org/afw.git    
cd afw
./afwdev build --install
</pre><h1><a class="anchor" id="autotoc_md18"></a>
Building on OpenSUSE Leap</h1>
<p>(tested on Leap 15.3)</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Rules to run at install time. dependencies</h2>
<pre class="fragment">zypper install gcc9 gcc9-c++ automake autoconf libtool apache2-devel \
    libapr1 libapr1-devel libxml2 libxml2-devel icu libicu-devel \
    libunwind libunwind-devel elfutils libdw1 libdw-devel libyaml-devel \
    FastCGI FastCGI-devel libmysqlclient-devel libdb-4_8 libdb-4_8-devel \
    libcurl-devel lmdb lmdb-devel doxygen rpm-build python3
</pre> <h2><a class="anchor" id="autotoc_md20"></a>
Building Adaptive Framework</h2>
<pre class="fragment">./afwdev build --install
</pre> <h1><a class="anchor" id="autotoc_md21"></a>
Building Docker image</h1>
<p>You may find it more useful to use the Dockerfile in the project root to create a docker container to run or develop your instance of Adaptive Framework. To get started, make sure you have docker installed on your system, then from the root of the Git repository, build an Adaptive Framework docker image, using: </p><pre class="fragment">docker build -t afwfcgi -f docker/images/afwfcgi/Dockerfile .
</pre><p> This uses CentOS 7 as the base image, and installs all necessary dependencies, used to build Adaptive Framework. It will take a while to build everything. Once finished, you will have a docker image from which you can make container(s) from. <br  />
</p>
<h2><a class="anchor" id="autotoc_md22"></a>
Run afw command from docker</h2>
<p>When running a simple afw command, such as afw, you typically don't want a persistent container. So, use the &ndash;rpm argument to have run the built image inside a new container, and have it automatically removed after the command ends. </p><pre class="fragment">docker run --rm afwfcgi afw -x 'add(1,2,3)'
</pre> <h2><a class="anchor" id="autotoc_md23"></a>
Get a shell to the docker container</h2>
<p>If you want to launch a container from the docker image and get shell access, while persisting changes to the container, you need to create a new container, start it, and attach to it. First, create a new container, which will launch an interactive shell. The -it argument makes it interactive, and /bin/sh is what's executed: </p><pre class="fragment">docker container create -p 8080:8080 -it --name afwfcgi afw /bin/sh
</pre><p> Now, attach to the container we named "afw": </p><pre class="fragment">docker attach afwfcgi
</pre><p> From here, we can change code, run builds and even startup afw_service_fcgi or nginx. Changes will persist in this container across restarts. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 2 2023 14:20:32 for Adaptive Framework by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
